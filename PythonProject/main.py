import sys
import random

import glm  # pip install PyGLM
import plotly.graph_objects as go

import svgwrite

from Point import Point
from Line import Line
from Cone import Cone
from Collision import Collision, CollisionLine


def points_to_scatter(point_array, form_triangle: bool):
    x_array = [point.x for point in point_array]
    y_array = [point.y for point in point_array]
    z_array = [point.z for point in point_array]
    if form_triangle:
        x_array.append(point_array[0].x)
        y_array.append(point_array[0].y)
        z_array.append(point_array[0].z)
    return [x_array, y_array, z_array]


def print_points(points):
    print("Want to recreate the same inputs? Copy line below:")
    print("points = [", end='')
    for point in points:
        print("Point(glm.vec3(" + str(point.x) + ", " + str(point.y) + ", " + str(point.z) + ")), ", end='')
    print("]")



def main(n, t, m):
    drawAllCollisions = False
    NO_POINTS = n
    THETA = t
    MEW = m
    MIN_X = 0
    MIN_Y = 0
    MIN_Z = 0
    MAX_X = 1000
    MAX_Y = 1000
    MAX_Z = 0

    points = [Point(glm.vec3(random.random() * MAX_X, random.random() * MAX_Y,
                             random.random() * MAX_Z), i) for i in range(NO_POINTS)]
    # Buggy inputs:
    #   Error when rounding: n = 5
    # points = [Point(glm.vec3(885.869140625, 538.2119140625, 0.0)), Point(glm.vec3(313.7813415527344, 756.8295288085938, 0.0)), Point(glm.vec3(924.343017578125, 636.501953125, 0.0)), Point(glm.vec3(400.0970153808594, 756.957763671875, 0.0)), Point(glm.vec3(65.90353393554688, 869.4907836914062, 0.0)), ]
    #   Error with NaN in normal dir? n = 250
    # points = [Point(glm.vec3(125.17713928222656, 838.6481323242188, 0.0)), Point(glm.vec3(751.6796875, 170.53602600097656, 0.0)), Point(glm.vec3(327.36236572265625, 416.0408020019531, 0.0)), Point(glm.vec3(662.0630493164062, 126.8289566040039, 0.0)), Point(glm.vec3(110.539794921875, 111.97134399414062, 0.0)), Point(glm.vec3(589.041015625, 122.83514404296875, 0.0)), Point(glm.vec3(76.03773498535156, 567.4397583007812, 0.0)), Point(glm.vec3(798.53271484375, 867.0066528320312, 0.0)), Point(glm.vec3(393.5541076660156, 895.37890625, 0.0)), Point(glm.vec3(628.5780029296875, 469.3189697265625, 0.0)), Point(glm.vec3(747.4935302734375, 244.43312072753906, 0.0)), Point(glm.vec3(876.904541015625, 15.898128509521484, 0.0)), Point(glm.vec3(548.5388793945312, 295.2676696777344, 0.0)), Point(glm.vec3(330.62109375, 553.9141235351562, 0.0)), Point(glm.vec3(485.0704650878906, 391.302001953125, 0.0)), Point(glm.vec3(530.9567260742188, 787.70263671875, 0.0)), Point(glm.vec3(397.8472595214844, 38.728797912597656, 0.0)), Point(glm.vec3(618.2874145507812, 761.6834716796875, 0.0)), Point(glm.vec3(308.3902587890625, 320.5961608886719, 0.0)), Point(glm.vec3(562.95751953125, 320.7244873046875, 0.0)), Point(glm.vec3(862.9016723632812, 540.2740478515625, 0.0)), Point(glm.vec3(275.3444519042969, 174.82061767578125, 0.0)), Point(glm.vec3(939.3003540039062, 5.873211860656738, 0.0)), Point(glm.vec3(491.08544921875, 388.8739013671875, 0.0)), Point(glm.vec3(663.365478515625, 589.3890991210938, 0.0)), Point(glm.vec3(84.00117492675781, 437.3174133300781, 0.0)), Point(glm.vec3(369.9527587890625, 850.9749145507812, 0.0)), Point(glm.vec3(283.05322265625, 369.3768615722656, 0.0)), Point(glm.vec3(971.75048828125, 524.92138671875, 0.0)), Point(glm.vec3(602.951171875, 392.3110046386719, 0.0)), Point(glm.vec3(975.362548828125, 791.1912841796875, 0.0)), Point(glm.vec3(785.4332885742188, 431.9457702636719, 0.0)), Point(glm.vec3(636.1445922851562, 173.4879608154297, 0.0)), Point(glm.vec3(659.2599487304688, 56.042911529541016, 0.0)), Point(glm.vec3(419.93798828125, 478.2568359375, 0.0)), Point(glm.vec3(214.84329223632812, 800.491455078125, 0.0)), Point(glm.vec3(850.4352416992188, 322.18267822265625, 0.0)), Point(glm.vec3(986.2579345703125, 636.779052734375, 0.0)), Point(glm.vec3(510.1514587402344, 172.81253051757812, 0.0)), Point(glm.vec3(451.29248046875, 731.97607421875, 0.0)), Point(glm.vec3(154.27529907226562, 918.7409057617188, 0.0)), Point(glm.vec3(311.1960144042969, 451.2516784667969, 0.0)), Point(glm.vec3(343.364013671875, 808.8546142578125, 0.0)), Point(glm.vec3(980.5426635742188, 439.685546875, 0.0)), Point(glm.vec3(755.27880859375, 108.42537689208984, 0.0)), Point(glm.vec3(842.728759765625, 835.9515380859375, 0.0)), Point(glm.vec3(763.6404418945312, 721.6607666015625, 0.0)), Point(glm.vec3(587.4329223632812, 117.73633575439453, 0.0)), Point(glm.vec3(992.234619140625, 141.24755859375, 0.0)), Point(glm.vec3(756.7864990234375, 790.767333984375, 0.0)), Point(glm.vec3(269.5863037109375, 150.0015106201172, 0.0)), Point(glm.vec3(198.187744140625, 301.41522216796875, 0.0)), Point(glm.vec3(940.8580322265625, 898.078857421875, 0.0)), Point(glm.vec3(745.3720703125, 110.96556091308594, 0.0)), Point(glm.vec3(631.2745361328125, 720.5927734375, 0.0)), Point(glm.vec3(46.713558197021484, 481.4901123046875, 0.0)), Point(glm.vec3(114.70624542236328, 25.85926628112793, 0.0)), Point(glm.vec3(880.3948974609375, 716.30859375, 0.0)), Point(glm.vec3(378.29229736328125, 656.4744262695312, 0.0)), Point(glm.vec3(612.8433227539062, 620.9407958984375, 0.0)), Point(glm.vec3(593.8286743164062, 960.8055419921875, 0.0)), Point(glm.vec3(162.39056396484375, 298.3587951660156, 0.0)), Point(glm.vec3(233.56593322753906, 741.3648681640625, 0.0)), Point(glm.vec3(678.4176025390625, 297.880126953125, 0.0)), Point(glm.vec3(595.8073120117188, 918.729248046875, 0.0)), Point(glm.vec3(425.4487609863281, 762.7750244140625, 0.0)), Point(glm.vec3(732.9705200195312, 585.74755859375, 0.0)), Point(glm.vec3(826.5882568359375, 226.60284423828125, 0.0)), Point(glm.vec3(278.72259521484375, 465.3988952636719, 0.0)), Point(glm.vec3(425.2297058105469, 190.02281188964844, 0.0)), Point(glm.vec3(516.8456420898438, 587.654052734375, 0.0)), Point(glm.vec3(424.9285583496094, 171.275634765625, 0.0)), Point(glm.vec3(217.77769470214844, 834.5972290039062, 0.0)), Point(glm.vec3(999.21044921875, 656.59423828125, 0.0)), Point(glm.vec3(427.7001953125, 824.5879516601562, 0.0)), Point(glm.vec3(698.1670532226562, 363.53631591796875, 0.0)), Point(glm.vec3(287.76470947265625, 238.98477172851562, 0.0)), Point(glm.vec3(387.9540100097656, 96.34467315673828, 0.0)), Point(glm.vec3(928.27587890625, 656.5725708007812, 0.0)), Point(glm.vec3(821.4404907226562, 220.53042602539062, 0.0)), Point(glm.vec3(312.1059265136719, 744.2323608398438, 0.0)), Point(glm.vec3(206.0889129638672, 190.50494384765625, 0.0)), Point(glm.vec3(795.7761840820312, 152.00804138183594, 0.0)), Point(glm.vec3(659.3345947265625, 818.3126220703125, 0.0)), Point(glm.vec3(267.034912109375, 201.50411987304688, 0.0)), Point(glm.vec3(29.14385223388672, 864.80078125, 0.0)), Point(glm.vec3(382.6377258300781, 225.6544189453125, 0.0)), Point(glm.vec3(857.6838989257812, 482.29913330078125, 0.0)), Point(glm.vec3(933.5540771484375, 740.1531372070312, 0.0)), Point(glm.vec3(451.6324768066406, 856.0337524414062, 0.0)), Point(glm.vec3(419.9515075683594, 589.3967895507812, 0.0)), Point(glm.vec3(862.7601318359375, 61.20317840576172, 0.0)), Point(glm.vec3(114.98979949951172, 132.95277404785156, 0.0)), Point(glm.vec3(166.32298278808594, 326.0904846191406, 0.0)), Point(glm.vec3(561.79150390625, 457.38934326171875, 0.0)), Point(glm.vec3(565.4035034179688, 161.2906951904297, 0.0)), Point(glm.vec3(720.021484375, 910.2745971679688, 0.0)), Point(glm.vec3(597.4682006835938, 258.7468566894531, 0.0)), Point(glm.vec3(51.20353317260742, 439.8556213378906, 0.0)), Point(glm.vec3(9.047525405883789, 213.4448699951172, 0.0)), Point(glm.vec3(889.0830078125, 88.4409408569336, 0.0)), Point(glm.vec3(310.4600830078125, 277.3382873535156, 0.0)), Point(glm.vec3(315.0370788574219, 778.965087890625, 0.0)), Point(glm.vec3(120.03466796875, 346.896484375, 0.0)), Point(glm.vec3(909.912109375, 917.0689697265625, 0.0)), Point(glm.vec3(686.632080078125, 276.05364990234375, 0.0)), Point(glm.vec3(465.7032470703125, 259.47332763671875, 0.0)), Point(glm.vec3(880.1488647460938, 444.1290588378906, 0.0)), Point(glm.vec3(772.472412109375, 806.142822265625, 0.0)), Point(glm.vec3(533.3875732421875, 353.87738037109375, 0.0)), Point(glm.vec3(828.7398681640625, 753.2467041015625, 0.0)), Point(glm.vec3(35.34895706176758, 232.39297485351562, 0.0)), Point(glm.vec3(466.0735778808594, 50.802059173583984, 0.0)), Point(glm.vec3(489.30926513671875, 4.842413425445557, 0.0)), Point(glm.vec3(988.8976440429688, 968.1593627929688, 0.0)), Point(glm.vec3(674.3786010742188, 61.062843322753906, 0.0)), Point(glm.vec3(267.3049621582031, 601.7655639648438, 0.0)), Point(glm.vec3(842.46533203125, 627.8425903320312, 0.0)), Point(glm.vec3(98.33977508544922, 792.7072143554688, 0.0)), Point(glm.vec3(452.94671630859375, 882.1981201171875, 0.0)), Point(glm.vec3(516.2533569335938, 633.3634643554688, 0.0)), Point(glm.vec3(545.9307250976562, 641.3960571289062, 0.0)), Point(glm.vec3(920.8411865234375, 112.41223907470703, 0.0)), Point(glm.vec3(671.3509521484375, 730.2647094726562, 0.0)), Point(glm.vec3(324.8806457519531, 3.057003974914551, 0.0)), Point(glm.vec3(716.3748779296875, 777.114013671875, 0.0)), Point(glm.vec3(360.13134765625, 6.974967002868652, 0.0)), Point(glm.vec3(217.8095245361328, 608.540771484375, 0.0)), Point(glm.vec3(213.4007110595703, 33.10831832885742, 0.0)), Point(glm.vec3(93.33491516113281, 427.6329040527344, 0.0)), Point(glm.vec3(801.8197631835938, 318.8878479003906, 0.0)), Point(glm.vec3(483.5690002441406, 50.324012756347656, 0.0)), Point(glm.vec3(213.9612274169922, 183.5867919921875, 0.0)), Point(glm.vec3(137.4250030517578, 287.00396728515625, 0.0)), Point(glm.vec3(464.4901428222656, 337.018310546875, 0.0)), Point(glm.vec3(613.7736206054688, 507.0749206542969, 0.0)), Point(glm.vec3(633.9862670898438, 691.9628295898438, 0.0)), Point(glm.vec3(296.3188171386719, 609.6568603515625, 0.0)), Point(glm.vec3(9.90749740600586, 28.94700050354004, 0.0)), Point(glm.vec3(382.1888427734375, 62.692176818847656, 0.0)), Point(glm.vec3(267.4572448730469, 543.5350341796875, 0.0)), Point(glm.vec3(790.865966796875, 53.72731399536133, 0.0)), Point(glm.vec3(565.7926635742188, 125.58332824707031, 0.0)), Point(glm.vec3(69.97575378417969, 550.7916870117188, 0.0)), Point(glm.vec3(255.91151428222656, 713.89697265625, 0.0)), Point(glm.vec3(838.9676513671875, 60.84620666503906, 0.0)), Point(glm.vec3(294.831298828125, 214.51385498046875, 0.0)), Point(glm.vec3(525.58642578125, 258.90667724609375, 0.0)), Point(glm.vec3(436.7019958496094, 796.3497314453125, 0.0)), Point(glm.vec3(633.9094848632812, 911.78515625, 0.0)), Point(glm.vec3(967.6902465820312, 399.9129638671875, 0.0)), Point(glm.vec3(971.9349975585938, 13.843534469604492, 0.0)), Point(glm.vec3(859.5698852539062, 381.6270446777344, 0.0)), Point(glm.vec3(259.10107421875, 185.94410705566406, 0.0)), Point(glm.vec3(332.0260925292969, 859.748046875, 0.0)), Point(glm.vec3(173.02749633789062, 553.7377319335938, 0.0)), Point(glm.vec3(459.1239929199219, 622.231201171875, 0.0)), Point(glm.vec3(81.52092742919922, 341.6582946777344, 0.0)), Point(glm.vec3(152.8263397216797, 546.9017333984375, 0.0)), Point(glm.vec3(211.2753448486328, 543.5086059570312, 0.0)), Point(glm.vec3(464.6287841796875, 535.3984375, 0.0)), Point(glm.vec3(540.8884887695312, 621.3721923828125, 0.0)), Point(glm.vec3(851.3781127929688, 151.938232421875, 0.0)), Point(glm.vec3(154.52989196777344, 443.812744140625, 0.0)), Point(glm.vec3(312.2110595703125, 407.1512145996094, 0.0)), Point(glm.vec3(881.0437622070312, 360.07049560546875, 0.0)), Point(glm.vec3(24.002607345581055, 527.7470092773438, 0.0)), Point(glm.vec3(444.97662353515625, 74.51988220214844, 0.0)), Point(glm.vec3(579.7239379882812, 884.4529418945312, 0.0)), Point(glm.vec3(229.2714385986328, 701.0546264648438, 0.0)), Point(glm.vec3(571.731201171875, 964.7749633789062, 0.0)), Point(glm.vec3(109.76153564453125, 160.1816864013672, 0.0)), Point(glm.vec3(569.1005249023438, 196.6462860107422, 0.0)), Point(glm.vec3(902.19091796875, 171.66378784179688, 0.0)), Point(glm.vec3(501.6150207519531, 111.7235107421875, 0.0)), Point(glm.vec3(274.2543029785156, 281.77288818359375, 0.0)), Point(glm.vec3(20.375185012817383, 203.31028747558594, 0.0)), Point(glm.vec3(10.82472038269043, 86.85987854003906, 0.0)), Point(glm.vec3(977.7600708007812, 833.2132568359375, 0.0)), Point(glm.vec3(959.0568237304688, 191.41522216796875, 0.0)), Point(glm.vec3(664.8436279296875, 388.8227844238281, 0.0)), Point(glm.vec3(416.46527099609375, 886.9631958007812, 0.0)), Point(glm.vec3(846.0744018554688, 792.5794677734375, 0.0)), Point(glm.vec3(559.8082885742188, 214.53005981445312, 0.0)), Point(glm.vec3(391.2542724609375, 105.61578369140625, 0.0)), Point(glm.vec3(991.1195678710938, 696.3988037109375, 0.0)), Point(glm.vec3(326.8067626953125, 467.6157531738281, 0.0)), Point(glm.vec3(84.0280532836914, 647.88623046875, 0.0)), Point(glm.vec3(688.1602783203125, 793.0617065429688, 0.0)), Point(glm.vec3(690.0017700195312, 692.0372314453125, 0.0)), Point(glm.vec3(989.7771606445312, 502.92620849609375, 0.0)), Point(glm.vec3(474.44342041015625, 992.6065673828125, 0.0)), Point(glm.vec3(291.5843505859375, 210.89210510253906, 0.0)), Point(glm.vec3(277.4609069824219, 699.9564208984375, 0.0)), Point(glm.vec3(772.2660522460938, 558.15087890625, 0.0)), Point(glm.vec3(369.8965759277344, 602.122802734375, 0.0)), Point(glm.vec3(368.7974548339844, 262.26080322265625, 0.0)), Point(glm.vec3(704.1763916015625, 738.57275390625, 0.0)), Point(glm.vec3(317.93603515625, 522.7310180664062, 0.0)), Point(glm.vec3(680.9057006835938, 928.2547607421875, 0.0)), Point(glm.vec3(584.5027465820312, 933.3385620117188, 0.0)), Point(glm.vec3(528.2421264648438, 231.44281005859375, 0.0)), Point(glm.vec3(781.3278198242188, 74.57020568847656, 0.0)), Point(glm.vec3(374.76141357421875, 701.9618530273438, 0.0)), Point(glm.vec3(532.0762939453125, 632.70263671875, 0.0)), Point(glm.vec3(349.9007263183594, 915.3753051757812, 0.0)), Point(glm.vec3(481.4733581542969, 391.3621520996094, 0.0)), Point(glm.vec3(229.10671997070312, 403.59490966796875, 0.0)), Point(glm.vec3(549.22509765625, 241.1029815673828, 0.0)), Point(glm.vec3(650.2515258789062, 565.8099365234375, 0.0)), Point(glm.vec3(947.1454467773438, 849.3511352539062, 0.0)), Point(glm.vec3(19.896577835083008, 138.8218231201172, 0.0)), Point(glm.vec3(224.97219848632812, 2.467531442642212, 0.0)), Point(glm.vec3(180.05401611328125, 176.35665893554688, 0.0)), Point(glm.vec3(347.5259094238281, 47.77940368652344, 0.0)), Point(glm.vec3(823.7935791015625, 972.3230590820312, 0.0)), Point(glm.vec3(823.3939819335938, 120.989501953125, 0.0)), Point(glm.vec3(818.453125, 600.3275146484375, 0.0)), Point(glm.vec3(810.6159057617188, 787.7965087890625, 0.0)), Point(glm.vec3(83.75547790527344, 205.4712677001953, 0.0)), Point(glm.vec3(926.0728759765625, 427.2684326171875, 0.0)), Point(glm.vec3(538.3755493164062, 984.6616821289062, 0.0)), Point(glm.vec3(895.4511108398438, 23.454084396362305, 0.0)), Point(glm.vec3(726.0612182617188, 346.61248779296875, 0.0)), Point(glm.vec3(769.5709228515625, 981.1991577148438, 0.0)), Point(glm.vec3(405.1874694824219, 730.2109375, 0.0)), Point(glm.vec3(386.3848571777344, 249.78160095214844, 0.0)), Point(glm.vec3(915.77392578125, 71.83794403076172, 0.0)), Point(glm.vec3(260.498779296875, 756.7972412109375, 0.0)), Point(glm.vec3(470.7697448730469, 432.037841796875, 0.0)), Point(glm.vec3(898.6670532226562, 945.787353515625, 0.0)), Point(glm.vec3(238.2416534423828, 696.4132690429688, 0.0)), Point(glm.vec3(966.6986694335938, 582.6705932617188, 0.0)), Point(glm.vec3(10.310844421386719, 672.1082763671875, 0.0)), Point(glm.vec3(968.8162231445312, 105.14885711669922, 0.0)), Point(glm.vec3(103.6960678100586, 451.5562438964844, 0.0)), Point(glm.vec3(282.7325744628906, 294.8834533691406, 0.0)), Point(glm.vec3(87.67345428466797, 672.1713256835938, 0.0)), Point(glm.vec3(269.1955871582031, 90.5503158569336, 0.0)), Point(glm.vec3(213.90602111816406, 14.753612518310547, 0.0)), Point(glm.vec3(110.54118347167969, 72.94966888427734, 0.0)), Point(glm.vec3(348.6347961425781, 752.8617553710938, 0.0)), Point(glm.vec3(24.4144344329834, 47.516029357910156, 0.0)), Point(glm.vec3(546.5674438476562, 429.50958251953125, 0.0)), Point(glm.vec3(71.77794647216797, 143.521484375, 0.0)), Point(glm.vec3(494.46575927734375, 390.1024475097656, 0.0)), Point(glm.vec3(125.6423110961914, 687.0242309570312, 0.0)), Point(glm.vec3(497.90753173828125, 461.72509765625, 0.0)), Point(glm.vec3(340.9859619140625, 867.939208984375, 0.0)), Point(glm.vec3(594.4802856445312, 645.0469970703125, 0.0)), ]

    # n = 300, wrong intersections
    # points = [Point(glm.vec3(6.2671918869018555, 572.92236328125, 0.0)), Point(glm.vec3(860.2093505859375, 977.4444580078125, 0.0)), Point(glm.vec3(1.9896965026855469, 65.20558166503906, 0.0)), Point(glm.vec3(5.437328815460205, 42.103572845458984, 0.0)), Point(glm.vec3(205.41241455078125, 167.615478515625, 0.0)), Point(glm.vec3(255.58197021484375, 658.90869140625, 0.0)), Point(glm.vec3(146.0406036376953, 356.93170166015625, 0.0)), Point(glm.vec3(792.3651123046875, 799.1837768554688, 0.0)), Point(glm.vec3(431.9530944824219, 735.792724609375, 0.0)), Point(glm.vec3(991.6229858398438, 410.4808349609375, 0.0)), Point(glm.vec3(595.9790649414062, 595.4918823242188, 0.0)), Point(glm.vec3(978.3104248046875, 344.9900207519531, 0.0)), Point(glm.vec3(885.8906860351562, 602.296630859375, 0.0)), Point(glm.vec3(941.8706665039062, 532.701171875, 0.0)), Point(glm.vec3(98.8896484375, 622.8515014648438, 0.0)), Point(glm.vec3(858.4168090820312, 973.0325927734375, 0.0)), Point(glm.vec3(306.24169921875, 701.2814331054688, 0.0)), Point(glm.vec3(267.0812683105469, 420.1981201171875, 0.0)), Point(glm.vec3(417.20843505859375, 842.194091796875, 0.0)), Point(glm.vec3(527.6112060546875, 772.1691284179688, 0.0)), Point(glm.vec3(565.0546264648438, 263.0109558105469, 0.0)), Point(glm.vec3(909.221435546875, 816.9420776367188, 0.0)), Point(glm.vec3(240.710693359375, 467.0588684082031, 0.0)), Point(glm.vec3(711.9732666015625, 416.9341735839844, 0.0)), Point(glm.vec3(531.0264892578125, 435.8131103515625, 0.0)), Point(glm.vec3(235.65147399902344, 561.9892578125, 0.0)), Point(glm.vec3(582.3267822265625, 667.8367309570312, 0.0)), Point(glm.vec3(368.30816650390625, 913.0266723632812, 0.0)), Point(glm.vec3(707.3596801757812, 48.10276794433594, 0.0)), Point(glm.vec3(560.78125, 172.78761291503906, 0.0)), Point(glm.vec3(717.766357421875, 286.0211181640625, 0.0)), Point(glm.vec3(11.210204124450684, 553.0357666015625, 0.0)), Point(glm.vec3(438.5134582519531, 574.5498657226562, 0.0)), Point(glm.vec3(826.7572021484375, 296.4966735839844, 0.0)), Point(glm.vec3(165.18955993652344, 728.5807495117188, 0.0)), Point(glm.vec3(559.3070068359375, 730.4719848632812, 0.0)), Point(glm.vec3(151.87277221679688, 977.152099609375, 0.0)), Point(glm.vec3(247.09317016601562, 624.9892578125, 0.0)), Point(glm.vec3(896.3909912109375, 642.7409057617188, 0.0)), Point(glm.vec3(332.834228515625, 611.4616088867188, 0.0)), Point(glm.vec3(840.994873046875, 265.045166015625, 0.0)), Point(glm.vec3(203.4051971435547, 643.3023071289062, 0.0)), Point(glm.vec3(908.524169921875, 502.70513916015625, 0.0)), Point(glm.vec3(317.8986511230469, 591.1640625, 0.0)), Point(glm.vec3(881.5918579101562, 166.57701110839844, 0.0)), Point(glm.vec3(85.2359848022461, 365.39129638671875, 0.0)), Point(glm.vec3(764.3782958984375, 764.4926147460938, 0.0)), Point(glm.vec3(112.64138793945312, 826.1638793945312, 0.0)), Point(glm.vec3(581.1704711914062, 180.42750549316406, 0.0)), Point(glm.vec3(920.383544921875, 857.8508911132812, 0.0)), Point(glm.vec3(617.3831176757812, 809.6638793945312, 0.0)), Point(glm.vec3(124.81155395507812, 2.8472630977630615, 0.0)), Point(glm.vec3(537.7731323242188, 162.44308471679688, 0.0)), Point(glm.vec3(588.7930297851562, 72.2481460571289, 0.0)), Point(glm.vec3(366.3695983886719, 609.5917358398438, 0.0)), Point(glm.vec3(342.4079895019531, 192.03433227539062, 0.0)), Point(glm.vec3(214.60841369628906, 696.0145263671875, 0.0)), Point(glm.vec3(909.2953491210938, 534.9553833007812, 0.0)), Point(glm.vec3(885.3521118164062, 261.948974609375, 0.0)), Point(glm.vec3(950.6943969726562, 284.40484619140625, 0.0)), Point(glm.vec3(778.3521728515625, 866.0569458007812, 0.0)), Point(glm.vec3(297.57635498046875, 948.1347045898438, 0.0)), Point(glm.vec3(636.4623413085938, 838.89892578125, 0.0)), Point(glm.vec3(207.78024291992188, 483.2528076171875, 0.0)), Point(glm.vec3(233.67733764648438, 466.1552734375, 0.0)), Point(glm.vec3(230.91099548339844, 118.17098236083984, 0.0)), Point(glm.vec3(418.1712341308594, 664.468017578125, 0.0)), Point(glm.vec3(713.67041015625, 398.04461669921875, 0.0)), Point(glm.vec3(721.1486206054688, 977.8217163085938, 0.0)), Point(glm.vec3(311.2958068847656, 650.6035766601562, 0.0)), Point(glm.vec3(473.9603576660156, 263.4657897949219, 0.0)), Point(glm.vec3(803.0616455078125, 484.62506103515625, 0.0)), Point(glm.vec3(696.8333129882812, 159.50582885742188, 0.0)), Point(glm.vec3(430.28656005859375, 167.99574279785156, 0.0)), Point(glm.vec3(604.2935180664062, 523.1090087890625, 0.0)), Point(glm.vec3(132.86878967285156, 102.00486755371094, 0.0)), Point(glm.vec3(566.7969970703125, 134.87698364257812, 0.0)), Point(glm.vec3(287.4673767089844, 926.6284790039062, 0.0)), Point(glm.vec3(402.0988464355469, 890.7750244140625, 0.0)), Point(glm.vec3(451.6595458984375, 132.917236328125, 0.0)), Point(glm.vec3(311.4784851074219, 569.72802734375, 0.0)), Point(glm.vec3(801.3023681640625, 150.83438110351562, 0.0)), Point(glm.vec3(962.747802734375, 385.6894836425781, 0.0)), Point(glm.vec3(182.59263610839844, 142.3540802001953, 0.0)), Point(glm.vec3(75.87926483154297, 410.4866943359375, 0.0)), Point(glm.vec3(568.816162109375, 579.3897094726562, 0.0)), Point(glm.vec3(346.06182861328125, 239.39381408691406, 0.0)), Point(glm.vec3(526.1275634765625, 662.3978881835938, 0.0)), Point(glm.vec3(857.1742553710938, 936.6777954101562, 0.0)), Point(glm.vec3(265.0745849609375, 601.3261108398438, 0.0)), Point(glm.vec3(294.779541015625, 23.063039779663086, 0.0)), Point(glm.vec3(189.87115478515625, 134.4717559814453, 0.0)), Point(glm.vec3(114.83241271972656, 93.28667449951172, 0.0)), Point(glm.vec3(984.2155151367188, 314.91986083984375, 0.0)), Point(glm.vec3(607.745361328125, 405.740478515625, 0.0)), Point(glm.vec3(999.5674438476562, 538.104248046875, 0.0)), Point(glm.vec3(465.2928161621094, 308.1925354003906, 0.0)), Point(glm.vec3(921.226806640625, 897.6644897460938, 0.0)), Point(glm.vec3(465.39056396484375, 405.2791748046875, 0.0)), Point(glm.vec3(515.6749267578125, 347.69073486328125, 0.0)), Point(glm.vec3(792.1442260742188, 769.1036376953125, 0.0)), Point(glm.vec3(868.3018798828125, 357.5673828125, 0.0)), Point(glm.vec3(359.3997497558594, 696.4613647460938, 0.0)), Point(glm.vec3(596.4442749023438, 439.1696472167969, 0.0)), Point(glm.vec3(379.3350830078125, 835.3744506835938, 0.0)), Point(glm.vec3(914.185546875, 597.5697021484375, 0.0)), Point(glm.vec3(87.17948913574219, 364.65948486328125, 0.0)), Point(glm.vec3(149.3170166015625, 497.2124938964844, 0.0)), Point(glm.vec3(743.0322265625, 232.06033325195312, 0.0)), Point(glm.vec3(759.3794555664062, 494.26904296875, 0.0)), Point(glm.vec3(129.013671875, 722.3421630859375, 0.0)), Point(glm.vec3(949.2356567382812, 644.783447265625, 0.0)), Point(glm.vec3(735.0213623046875, 548.6283569335938, 0.0)), Point(glm.vec3(814.9691162109375, 104.09014892578125, 0.0)), Point(glm.vec3(792.3468017578125, 242.56246948242188, 0.0)), Point(glm.vec3(757.9783325195312, 554.8062133789062, 0.0)), Point(glm.vec3(927.1273803710938, 478.81170654296875, 0.0)), Point(glm.vec3(308.9759826660156, 475.1271057128906, 0.0)), Point(glm.vec3(959.8743286132812, 994.6763916015625, 0.0)), Point(glm.vec3(595.8134765625, 342.26593017578125, 0.0)), Point(glm.vec3(174.68515014648438, 675.5343627929688, 0.0)), Point(glm.vec3(127.36386108398438, 837.7357177734375, 0.0)), Point(glm.vec3(46.09072494506836, 347.16741943359375, 0.0)), Point(glm.vec3(41.20866775512695, 74.01902770996094, 0.0)), Point(glm.vec3(297.4176940917969, 258.91156005859375, 0.0)), Point(glm.vec3(195.2926025390625, 641.3319091796875, 0.0)), Point(glm.vec3(27.471817016601562, 736.6710205078125, 0.0)), Point(glm.vec3(456.2742614746094, 604.9594116210938, 0.0)), Point(glm.vec3(12.895272254943848, 49.97195816040039, 0.0)), Point(glm.vec3(914.6060791015625, 142.33511352539062, 0.0)), Point(glm.vec3(197.7105712890625, 460.9828186035156, 0.0)), Point(glm.vec3(238.94895935058594, 530.2462158203125, 0.0)), Point(glm.vec3(684.7238159179688, 50.53709030151367, 0.0)), Point(glm.vec3(328.57171630859375, 197.56573486328125, 0.0)), Point(glm.vec3(685.9795532226562, 610.8770141601562, 0.0)), Point(glm.vec3(18.77962875366211, 602.28125, 0.0)), Point(glm.vec3(623.0760498046875, 736.8994140625, 0.0)), Point(glm.vec3(331.75433349609375, 73.64180755615234, 0.0)), Point(glm.vec3(43.063079833984375, 940.7083740234375, 0.0)), Point(glm.vec3(583.0348510742188, 654.6436767578125, 0.0)), Point(glm.vec3(635.802978515625, 504.2349853515625, 0.0)), Point(glm.vec3(195.07337951660156, 162.38427734375, 0.0)), Point(glm.vec3(789.5851440429688, 438.3348693847656, 0.0)), Point(glm.vec3(925.3843383789062, 807.938720703125, 0.0)), Point(glm.vec3(535.0573120117188, 456.65655517578125, 0.0)), Point(glm.vec3(132.04901123046875, 103.28753662109375, 0.0)), Point(glm.vec3(585.5284423828125, 339.1727600097656, 0.0)), Point(glm.vec3(234.9641876220703, 280.3855895996094, 0.0)), Point(glm.vec3(876.5654296875, 316.8323059082031, 0.0)), Point(glm.vec3(272.3489685058594, 204.1638641357422, 0.0)), Point(glm.vec3(960.6907348632812, 638.9469604492188, 0.0)), Point(glm.vec3(348.960693359375, 163.53170776367188, 0.0)), Point(glm.vec3(326.64813232421875, 509.4712829589844, 0.0)), Point(glm.vec3(687.2544555664062, 683.8336181640625, 0.0)), Point(glm.vec3(38.78681945800781, 35.86170959472656, 0.0)), Point(glm.vec3(279.1179504394531, 213.00772094726562, 0.0)), Point(glm.vec3(100.17145538330078, 270.15057373046875, 0.0)), Point(glm.vec3(512.9014282226562, 821.8230590820312, 0.0)), Point(glm.vec3(863.8128662109375, 200.59275817871094, 0.0)), Point(glm.vec3(43.23463821411133, 700.80126953125, 0.0)), Point(glm.vec3(165.85662841796875, 217.16285705566406, 0.0)), Point(glm.vec3(659.5203247070312, 621.6487426757812, 0.0)), Point(glm.vec3(135.53640747070312, 611.3555297851562, 0.0)), Point(glm.vec3(807.3383178710938, 178.880859375, 0.0)), Point(glm.vec3(198.7969207763672, 45.05841827392578, 0.0)), Point(glm.vec3(198.1580352783203, 320.39385986328125, 0.0)), Point(glm.vec3(332.98388671875, 284.69219970703125, 0.0)), Point(glm.vec3(499.5295715332031, 150.1359405517578, 0.0)), Point(glm.vec3(511.8344421386719, 606.2119750976562, 0.0)), Point(glm.vec3(426.04656982421875, 589.2354736328125, 0.0)), Point(glm.vec3(103.67684936523438, 480.872314453125, 0.0)), Point(glm.vec3(971.9264526367188, 923.3294677734375, 0.0)), Point(glm.vec3(899.765869140625, 139.35406494140625, 0.0)), Point(glm.vec3(188.5775604248047, 594.4652099609375, 0.0)), Point(glm.vec3(421.67022705078125, 913.2135620117188, 0.0)), Point(glm.vec3(229.5918426513672, 235.90220642089844, 0.0)), Point(glm.vec3(296.3077392578125, 266.89117431640625, 0.0)), Point(glm.vec3(344.80523681640625, 942.7129516601562, 0.0)), Point(glm.vec3(119.66234588623047, 138.99012756347656, 0.0)), Point(glm.vec3(513.0582885742188, 348.6911926269531, 0.0)), Point(glm.vec3(935.3638916015625, 535.3151245117188, 0.0)), Point(glm.vec3(643.1099853515625, 904.6002807617188, 0.0)), Point(glm.vec3(319.6255187988281, 648.7975463867188, 0.0)), Point(glm.vec3(474.3078308105469, 839.3067626953125, 0.0)), Point(glm.vec3(252.54928588867188, 128.8935089111328, 0.0)), Point(glm.vec3(904.5051879882812, 802.3040771484375, 0.0)), Point(glm.vec3(176.18426513671875, 644.0299072265625, 0.0)), Point(glm.vec3(164.54293823242188, 814.1975708007812, 0.0)), Point(glm.vec3(223.7637176513672, 207.01922607421875, 0.0)), Point(glm.vec3(653.1548461914062, 829.0785522460938, 0.0)), Point(glm.vec3(16.50384521484375, 764.024169921875, 0.0)), Point(glm.vec3(848.4364013671875, 75.06417846679688, 0.0)), Point(glm.vec3(550.5824584960938, 46.22348403930664, 0.0)), Point(glm.vec3(683.884521484375, 170.81471252441406, 0.0)), Point(glm.vec3(231.21408081054688, 452.6911926269531, 0.0)), Point(glm.vec3(398.1487121582031, 59.75291442871094, 0.0)), Point(glm.vec3(718.0345458984375, 271.7699890136719, 0.0)), Point(glm.vec3(6.9608564376831055, 702.620361328125, 0.0)), Point(glm.vec3(807.2224731445312, 101.79319763183594, 0.0)), Point(glm.vec3(516.3299560546875, 513.1875610351562, 0.0)), Point(glm.vec3(724.041259765625, 708.8438110351562, 0.0)), Point(glm.vec3(626.1577758789062, 52.92158889770508, 0.0)), Point(glm.vec3(747.0325927734375, 304.14544677734375, 0.0)), Point(glm.vec3(718.685302734375, 50.468833923339844, 0.0)), Point(glm.vec3(427.4035949707031, 302.9545593261719, 0.0)), Point(glm.vec3(436.1658935546875, 332.2253112792969, 0.0)), Point(glm.vec3(732.1525268554688, 310.2309265136719, 0.0)), Point(glm.vec3(714.0848999023438, 216.3662109375, 0.0)), Point(glm.vec3(58.279144287109375, 641.5278930664062, 0.0)), Point(glm.vec3(572.4320068359375, 513.5473022460938, 0.0)), Point(glm.vec3(329.5672607421875, 454.39312744140625, 0.0)), Point(glm.vec3(624.7157592773438, 68.18099975585938, 0.0)), Point(glm.vec3(989.583740234375, 908.94873046875, 0.0)), Point(glm.vec3(69.44605255126953, 316.6677551269531, 0.0)), Point(glm.vec3(578.9971313476562, 632.5884399414062, 0.0)), Point(glm.vec3(479.5537109375, 108.07559204101562, 0.0)), Point(glm.vec3(529.5283813476562, 874.7774047851562, 0.0)), Point(glm.vec3(841.1864624023438, 780.8582153320312, 0.0)), Point(glm.vec3(988.5222778320312, 470.99566650390625, 0.0)), Point(glm.vec3(840.4656982421875, 411.2080383300781, 0.0)), Point(glm.vec3(293.8560485839844, 833.3609619140625, 0.0)), Point(glm.vec3(503.9245910644531, 931.695068359375, 0.0)), Point(glm.vec3(111.47725677490234, 679.7424926757812, 0.0)), Point(glm.vec3(711.3701782226562, 110.70887756347656, 0.0)), Point(glm.vec3(379.444091796875, 583.483642578125, 0.0)), Point(glm.vec3(740.298095703125, 794.11962890625, 0.0)), Point(glm.vec3(123.12950897216797, 592.919189453125, 0.0)), Point(glm.vec3(340.4476623535156, 832.2060546875, 0.0)), Point(glm.vec3(61.347408294677734, 27.420076370239258, 0.0)), Point(glm.vec3(306.6602478027344, 922.3795166015625, 0.0)), Point(glm.vec3(165.45713806152344, 55.81086730957031, 0.0)), Point(glm.vec3(391.101806640625, 447.93963623046875, 0.0)), Point(glm.vec3(693.7744750976562, 33.26350402832031, 0.0)), Point(glm.vec3(317.880859375, 758.4172973632812, 0.0)), Point(glm.vec3(30.838274002075195, 583.7913818359375, 0.0)), Point(glm.vec3(225.823486328125, 966.0225830078125, 0.0)), Point(glm.vec3(156.23707580566406, 144.37477111816406, 0.0)), Point(glm.vec3(367.0511169433594, 597.8165283203125, 0.0)), Point(glm.vec3(638.5406494140625, 674.7232666015625, 0.0)), Point(glm.vec3(237.33184814453125, 121.95660400390625, 0.0)), Point(glm.vec3(106.16485595703125, 684.1185302734375, 0.0)), Point(glm.vec3(344.022705078125, 104.25724029541016, 0.0)), Point(glm.vec3(164.3570098876953, 960.2335815429688, 0.0)), Point(glm.vec3(141.93447875976562, 254.8959503173828, 0.0)), Point(glm.vec3(875.3023071289062, 520.0390625, 0.0)), Point(glm.vec3(820.7122802734375, 534.7467651367188, 0.0)), Point(glm.vec3(930.7665405273438, 152.8375701904297, 0.0)), Point(glm.vec3(764.879638671875, 161.5712890625, 0.0)), Point(glm.vec3(88.96377563476562, 730.4644165039062, 0.0)), Point(glm.vec3(648.14794921875, 835.65869140625, 0.0)), Point(glm.vec3(211.771728515625, 795.9083862304688, 0.0)), Point(glm.vec3(150.6864776611328, 28.207996368408203, 0.0)), Point(glm.vec3(759.8182373046875, 334.1165771484375, 0.0)), Point(glm.vec3(666.2236938476562, 784.797607421875, 0.0)), Point(glm.vec3(597.7179565429688, 333.50225830078125, 0.0)), Point(glm.vec3(559.695068359375, 232.17071533203125, 0.0)), Point(glm.vec3(700.2476196289062, 479.25616455078125, 0.0)), Point(glm.vec3(950.0916137695312, 183.55197143554688, 0.0)), Point(glm.vec3(683.3201293945312, 544.1822509765625, 0.0)), Point(glm.vec3(391.8536376953125, 834.64794921875, 0.0)), Point(glm.vec3(601.8674926757812, 511.8063659667969, 0.0)), Point(glm.vec3(424.5570373535156, 114.03672790527344, 0.0)), Point(glm.vec3(70.17143249511719, 399.4251708984375, 0.0)), Point(glm.vec3(822.7313842773438, 175.07281494140625, 0.0)), Point(glm.vec3(189.67652893066406, 366.36260986328125, 0.0)), Point(glm.vec3(489.42425537109375, 110.4712142944336, 0.0)), Point(glm.vec3(127.830078125, 588.6891479492188, 0.0)), Point(glm.vec3(346.7080078125, 247.19992065429688, 0.0)), Point(glm.vec3(165.87376403808594, 569.1563110351562, 0.0)), Point(glm.vec3(450.0343322753906, 794.9291381835938, 0.0)), Point(glm.vec3(64.5836410522461, 1.98941969871521, 0.0)), Point(glm.vec3(95.01113891601562, 56.37111282348633, 0.0)), Point(glm.vec3(114.23565673828125, 288.08612060546875, 0.0)), Point(glm.vec3(770.8582153320312, 316.5367126464844, 0.0)), Point(glm.vec3(945.8510131835938, 406.982666015625, 0.0)), Point(glm.vec3(522.87841796875, 782.7321166992188, 0.0)), Point(glm.vec3(691.593017578125, 745.0103759765625, 0.0)), Point(glm.vec3(659.51318359375, 141.9065399169922, 0.0)), Point(glm.vec3(782.1624755859375, 674.648681640625, 0.0)), Point(glm.vec3(917.88427734375, 450.69989013671875, 0.0)), Point(glm.vec3(523.1901245117188, 571.9922485351562, 0.0)), Point(glm.vec3(460.8054504394531, 908.1685180664062, 0.0)), Point(glm.vec3(799.4948120117188, 983.6455078125, 0.0)), Point(glm.vec3(413.44427490234375, 127.7138900756836, 0.0)), Point(glm.vec3(435.3194580078125, 535.4448852539062, 0.0)), Point(glm.vec3(29.979814529418945, 789.867919921875, 0.0)), Point(glm.vec3(481.85296630859375, 577.138427734375, 0.0)), Point(glm.vec3(558.8384399414062, 887.6403198242188, 0.0)), Point(glm.vec3(613.7644653320312, 716.0755615234375, 0.0)), Point(glm.vec3(149.14138793945312, 392.30010986328125, 0.0)), Point(glm.vec3(46.86159896850586, 876.5850219726562, 0.0)), Point(glm.vec3(134.93893432617188, 782.1683349609375, 0.0)), Point(glm.vec3(584.8045654296875, 866.50927734375, 0.0)), Point(glm.vec3(183.42282104492188, 170.5696563720703, 0.0)), Point(glm.vec3(888.4303588867188, 104.92742919921875, 0.0)), Point(glm.vec3(853.9046630859375, 87.62983703613281, 0.0)), Point(glm.vec3(787.561767578125, 715.21142578125, 0.0)), Point(glm.vec3(468.8845520019531, 889.3429565429688, 0.0)), Point(glm.vec3(754.2196044921875, 381.4825134277344, 0.0)), Point(glm.vec3(113.3096923828125, 128.444580078125, 0.0)), Point(glm.vec3(532.9400024414062, 182.8165283203125, 0.0)), Point(glm.vec3(84.86521911621094, 498.4364929199219, 0.0)), Point(glm.vec3(773.3991088867188, 42.9732780456543, 0.0)), Point(glm.vec3(350.5306091308594, 578.2892456054688, 0.0)), Point(glm.vec3(789.014404296875, 951.5337524414062, 0.0)), Point(glm.vec3(959.6951904296875, 167.273193359375, 0.0)), Point(glm.vec3(784.9883422851562, 771.5823974609375, 0.0)), Point(glm.vec3(232.41783142089844, 34.076236724853516, 0.0)), Point(glm.vec3(439.4112854003906, 995.1781005859375, 0.0)), Point(glm.vec3(435.538818359375, 716.7274169921875, 0.0)), Point(glm.vec3(424.1279296875, 210.92636108398438, 0.0)), Point(glm.vec3(281.0545349121094, 67.63885498046875, 0.0)), Point(glm.vec3(542.1450805664062, 866.1045532226562, 0.0)), Point(glm.vec3(731.14404296875, 413.11688232421875, 0.0)), Point(glm.vec3(931.568115234375, 766.2794189453125, 0.0)), Point(glm.vec3(823.0572509765625, 607.7598266601562, 0.0)), Point(glm.vec3(130.5441131591797, 715.1749267578125, 0.0)), Point(glm.vec3(867.251953125, 120.7295913696289, 0.0)), Point(glm.vec3(738.2403564453125, 807.5547485351562, 0.0)), Point(glm.vec3(251.80018615722656, 699.4730834960938, 0.0)), Point(glm.vec3(609.3328247070312, 501.68853759765625, 0.0)), Point(glm.vec3(191.1884002685547, 253.67788696289062, 0.0)), Point(glm.vec3(576.9551391601562, 828.1709594726562, 0.0)), Point(glm.vec3(114.54945373535156, 735.2931518554688, 0.0)), Point(glm.vec3(649.2647094726562, 954.6824340820312, 0.0)), Point(glm.vec3(704.5068969726562, 848.783935546875, 0.0)), Point(glm.vec3(305.1530456542969, 203.0219268798828, 0.0)), Point(glm.vec3(531.04248046875, 23.54802894592285, 0.0)), Point(glm.vec3(647.3145141601562, 170.32305908203125, 0.0)), Point(glm.vec3(554.2259521484375, 729.4336547851562, 0.0)), Point(glm.vec3(754.54296875, 102.9702377319336, 0.0)), Point(glm.vec3(424.93817138671875, 324.71136474609375, 0.0)), Point(glm.vec3(640.6880493164062, 436.0505065917969, 0.0)), Point(glm.vec3(839.2506103515625, 158.16171264648438, 0.0)), Point(glm.vec3(550.5870361328125, 298.4156494140625, 0.0)), Point(glm.vec3(421.79022216796875, 810.09326171875, 0.0)), Point(glm.vec3(241.0386962890625, 793.697998046875, 0.0)), Point(glm.vec3(652.8153686523438, 256.9423828125, 0.0)), Point(glm.vec3(462.7039489746094, 700.5323486328125, 0.0)), Point(glm.vec3(202.7483673095703, 107.16727447509766, 0.0)), Point(glm.vec3(103.53271484375, 86.11672973632812, 0.0)), Point(glm.vec3(62.605926513671875, 358.3860168457031, 0.0)), Point(glm.vec3(330.4355163574219, 161.38487243652344, 0.0)), Point(glm.vec3(935.760986328125, 198.04843139648438, 0.0)), Point(glm.vec3(90.07353973388672, 539.4347534179688, 0.0)), Point(glm.vec3(724.1349487304688, 979.4992065429688, 0.0)), Point(glm.vec3(247.78616333007812, 877.8881225585938, 0.0)), Point(glm.vec3(477.4266357421875, 954.2439575195312, 0.0)), Point(glm.vec3(206.45338439941406, 616.3173217773438, 0.0)), Point(glm.vec3(192.28073120117188, 203.46998596191406, 0.0)), ]
    print_points(points)

    cones = [Cone(points[i], THETA, MEW, i) for i in range(len(points))]

    all_collisions = []
    count = 1
    total = int(NO_POINTS * NO_POINTS / 2 - (NO_POINTS/2))
    for i in range(NO_POINTS):
        for j in range(i + 1, NO_POINTS):
            print("Generating Collisions: " + str(count) + " of " + str(total))
            all_collisions.append(Collision(cones[i], cones[j]))
            count += 1

    all_collisions.sort(key=lambda d: d.scale)

    triangles = []
    col_points = []
    col_lines = []
    col_line_id = 0
    connected_lines = []

    def setCollisionLineEnd(id: int, intersectionPoint: Point):
        print("Connection Progress: "+str(len(connected_lines))+" of ~"+str(n*6))
        for col_linee in col_lines:
            if col_linee.id == id:
                col_linee.setEnd(intersectionPoint)
                connected_lines.append(col_linee)
                return


    count = 1
    for collision in all_collisions:
        print("Checking Collisions: " + str(count) + " of " + str(len(all_collisions)))
        count+=1
        ignore = False
        for cone in cones:
            # If the collision happens inside a cone, it won't be valid so we ignore it
            if cone.center != collision.topCone.center and cone.center != collision.bottomCone.center \
                    and cone.point_inside_cone(collision.collision_point, collision.scale):
                ignore = True
                break
        if not ignore:
            # Add collision
            col_points.append(collision.collision_point)
            collision.calculate_directions()
            col_lines.append(CollisionLine(Line(collision.collision_point, collision.collision_direction_1),
                                           collision.coneIDs, col_line_id))
            col_line_id += 1
            col_lines.append(CollisionLine(Line(collision.collision_point, collision.collision_direction_2),
                                           collision.coneIDs, col_line_id))
            col_line_id += 1

            # Create triangles for debugging
            triangles.append(collision.topCone.get_triangle_vertices(collision.scale, collision.vector_between))
            triangles.append(collision.bottomCone.get_triangle_vertices(collision.scale, collision.vector_between))

    # Connect the collision lines, depending on their cones
    for col_line in col_lines:
        breakFlag = False
        if not col_line.foundEnd:
            coneIDs = col_line.coneIDs
            for other_col_line in col_lines:
                # check if they're not from the same collision
                if not other_col_line.foundEnd:
                    if other_col_line.id != col_line.id:
                        # check if they share the first coneID
                        otherConeIDs = other_col_line.coneIDs
                        if coneIDs[0] == otherConeIDs[0]:
                            # we search for a third collision which has the missing 2 IDs
                            missingIDs = [coneIDs[1], otherConeIDs[1]]
                            missingIDs.sort()
                            for third_col_line in col_lines:
                                if not third_col_line.foundEnd:
                                    if missingIDs == third_col_line.coneIDs:
                                        # there are always 2 of those, so we need to check which intersects
                                        intersections = col_line.findClosestIntersections(
                                            [other_col_line, third_col_line])
                                        if intersections[1]:
                                            # The three lines intersect (yay)
                                            intersectionPoint = col_line.line.findIntersection2D(other_col_line.line)
                                            if True:
                                                # We found 3 lines that form an intersection in the diagram
                                                setCollisionLineEnd(col_line.id, intersectionPoint)
                                                setCollisionLineEnd(other_col_line.id, intersectionPoint)
                                                setCollisionLineEnd(third_col_line.id, intersectionPoint)
                                                breakFlag = True
                                                break
                            if breakFlag:
                                break

    quadBoundaryLines = [
        CollisionLine(Line(Point(glm.vec3(MIN_X, MIN_Y, MIN_Z)), glm.vec3(1, 0, 0)), [0,0], col_line_id),
        CollisionLine(Line(Point(glm.vec3(MIN_X, MIN_Y, MIN_Z)), glm.vec3(0, 1, 0)), [0,0], col_line_id+1),
        CollisionLine(Line(Point(glm.vec3(MAX_X, MIN_Y, MIN_Z)), glm.vec3(0, 1, 0)), [0,0], col_line_id+2),
        CollisionLine(Line(Point(glm.vec3(MIN_X, MAX_Y, MIN_Z)), glm.vec3(1, 0, 0)), [0,0], col_line_id+3),
    ]

    # At a certain point number, some intersections are wrong, so we want to avoid problems
    if NO_POINTS > 250:
        for col_line in col_lines:
            if not col_line.foundEnd:
                first_colliding_line = col_line.findClosestIntersections(connected_lines)[0]
                if first_colliding_line:
                    intersectionPoint = col_line.line.findIntersection2D(first_colliding_line.line)
                    setCollisionLineEnd(col_line.id, intersectionPoint)


    # Handle all collisions with wall
    # TODO: Avoid the wrong lines by crossing them with final lines?
    for col_line in col_lines:
        if not col_line.foundEnd:
            wallHit = col_line.findClosestIntersections(quadBoundaryLines)
            if wallHit[0]:
                intersectionPoint = col_line.line.findIntersection2D(wallHit[0].line)
                setCollisionLineEnd(col_line.id, intersectionPoint)
            else:
                print("Didn't hit any walls")



    # We need to adjust all the collision lines which are or go outside of our bounds

    print("Adjusting Lines for Outer Bounds")
    final_lines = []
    for col_line in connected_lines:
        # At a certain point number, some lines just can't find intersections ??
        # This erases the buggy lines but leaves some wholes:
        if NO_POINTS <= 250 or col_line.line.p.euclidean_distance(col_line.line.end) < MAX_X*1.41421356237:
            line = col_line.line
            if line.end.coords.y >= MIN_Y and line.p.coords.y >= MIN_Y:
                final_lines.append(col_line)
            elif line.end.coords.y > MIN_Y or line.p.coords.y > MIN_Y:
                if line.end.coords.y > MIN_Y:
                    new_line = Line(line.end, line.norm_dir * -1)
                    intersectionPoint = new_line.findIntersection2D(quadBoundaryLines[0].line)
                    col_line.line.p = intersectionPoint
                else:
                    intersectionPoint = col_line.line.findIntersection2D(quadBoundaryLines[0].line)
                    col_line.line.end = intersectionPoint
                final_lines.append(col_line)

    """

    final_lines = []
    for col_line in connected_lines:
        if col_line not in buggy_line_ids:
            final_lines.append(col_line)
    """

    """
    def findNextIntersection(inputLine, closestLines=None):
        if closestLines is None:
            closestLines = inputLine.findClosestIntersections(col_lines)

        closestLine = closestLines[0]
        secondClosestLine = closestLines[1]

        if not closestLine:
            # Inputline has no hit lines, i.e. it goes out of bounds
            wallHit = inputLine.findClosestIntersections(quadBoundaryLines)
            intersectionPoint = inputLine.line.findIntersection2D(wallHit[0].line)
            setCollisionLineEnd(inputLine.id, intersectionPoint)
            return False

        if secondClosestLine:
            intersectionPoint = inputLine.line.findIntersection2D(closestLine.line)
            intersectionPoint2 = inputLine.line.findIntersection2D(secondClosestLine.line)
            if intersectionPoint.euclidean_distance(intersectionPoint2) < 0.1:
                # We found 3 lines that form an intersection in the diagram
                setCollisionLineEnd(inputLine.id, intersectionPoint)
                setCollisionLineEnd(closestLine.id, intersectionPoint)
                setCollisionLineEnd(secondClosestLine.id, intersectionPoint)
                return False

        # The 3 lines do not form an intersectionPoint
        # We need to find out if the input line is also closest from the hit line's origin
        closestLineClosestLines = closestLine.findClosestIntersections(col_lines)

        if closestLineClosestLines[0].id == inputLine.id:
            intersectionPoint = closestLineClosestLines[0].line.findIntersection2D(closestLine.line)
            setCollisionLineEnd(closestLine.id, intersectionPoint)
            setCollisionLineEnd(closestLineClosestLines[0].id, intersectionPoint)
            if closestLineClosestLines[1]:
                intersectionPoint2 = closestLineClosestLines[1].line.findIntersection2D(closestLine.line)
                if intersectionPoint.euclidean_distance(intersectionPoint2) < 0.1:
                    setCollisionLineEnd(closestLineClosestLines[1].id, intersectionPoint)
            return False

        elif closestLineClosestLines[1] and closestLineClosestLines[1].id == inputLine.id:
            intersectionPoint = closestLineClosestLines[1].line.findIntersection2D(closestLine.line)
            setCollisionLineEnd(closestLine.id, intersectionPoint)
            setCollisionLineEnd(closestLineClosestLines[1].id, intersectionPoint)
            intersectionPoint2 = closestLineClosestLines[0].line.findIntersection2D(closestLine.line)
            if intersectionPoint.euclidean_distance(intersectionPoint2) < 0.1:
                setCollisionLineEnd(closestLineClosestLines[0].id, intersectionPoint)
            return False

        else:
            # The hit line has a closer neighbor, we start the function again with those two lines as input
            return[closestLine, closestLineClosestLines]

    i = 0
    if drawAllCollisions:
    i = len(col_lines)
    final_lines = col_lines
    while i < len(col_lines):
        print(str(i) + "/" + str(len(col_lines)))
        line = col_lines[i]
        if not line.foundEnd:
            newInputLines = findNextIntersection(line)
            while newInputLines:
                print(str(i) + "/" + str(len(col_lines)))
                print(newInputLines[0].id, newInputLines[1][0].id, newInputLines[1][1].id)
                newInputLines = findNextIntersection(newInputLines[0], newInputLines[1])
        else:
            i += 1

        # Ideas for Cone:
        # Remove all further collisions inside the area those 3 lines form
        # (maybe research point inside non-convex hull polynomials)
    """



    """Save SVG"""
    print("Writing to SVG...")
    dwg = svgwrite.Drawing('../voronoi-'+str(int(THETA))+'-'+str(MEW)+'-'+str(NO_POINTS)+'.svg', size=(MAX_X, MAX_Y))
    for col_line in final_lines:
        if col_line.foundEnd:
            line = col_line.line
            dwg.add(dwg.line((line.p.coords.x, MAX_Y - line.p.coords.y),
                             (line.end.coords.x, MAX_Y - line.end.coords.y),
                             stroke=svgwrite.rgb(0, 0, 0, '%'), stroke_width='1'))
        else:
            print("No End of line for ID: "+str(col_line.id))
    dwg.save()


    """Render Stuff"""
    print("Preparing Render...")
    lines = []

    for col_line in final_lines:
        if col_line.foundEnd:
            line = col_line.line
            lines.append([line.p.coords, line.end.coords])
        else:
            print("No End of line for ID: " + str(col_line.id))
            #lines.append([line.p.coords, line.p.coords + line.norm_dir * 100])

    scatter_points = points_to_scatter(points, False)

    scatter_lines = []
    for line in lines:
        scatter_lines.append(points_to_scatter(line, False))
    scatter_buggy = []
    #for line in buggy_lines:
    #    scatter_buggy.append(points_to_scatter(line, False))
    scatter_collisions = points_to_scatter(col_points, False)


    data = []
    data.append(go.Scatter3d(x=scatter_points[0], y=scatter_points[1], z=scatter_points[2],
                             mode='markers', marker={'color': 'blue', 'size': 5}))
    for scatter_line in scatter_lines:
        data.append(go.Scatter3d(x=scatter_line[0], y=scatter_line[1], z=scatter_line[2], mode='lines',
                                 line={'color': 'black'}))

    #for scatter_line in scatter_buggy:
    #    data.append(go.Scatter3d(x=scatter_line[0], y=scatter_line[1], z=scatter_line[2], mode='lines',
    #                             line={'color': 'red'}))

    # scatter_triangles = []
    # for triangle in triangles:
    #    scatter_triangles.append(points_to_scatter(triangle, True))
    # for scatter_triangle in scatter_triangles:
    #    data.append(go.Scatter3d(x=scatter_triangle[0], y=scatter_triangle[1], z=scatter_triangle[2], mode='lines',
    #                             line={'color': "lightblue"}))


    #data.append(go.Scatter3d(x=scatter_collisions[0], y=scatter_collisions[1], z=scatter_collisions[2],
    #                                     mode='markers', marker={'color': 'violet', 'size': 5}))


    fig = go.Figure(data=data)
    """fig.update_layout(
        scene=dict(
            xaxis=dict(tickmode="linear", range=[MIN_X, MAX_X], linewidth=1),
            yaxis=dict(tickmode="linear", range=[MIN_Y, MAX_Y], linewidth=1),
            zaxis=dict(tickmode="linear", range=[MIN_Z, MAX_Z], linewidth=1),
        ))"""
    fig.show()
    print_points(points)


if __name__ == '__main__':
    if len(sys.argv) > 3 and 0 <= float(sys.argv[3]) <= 1 and 0 <= float(sys.argv[2]) <= 90:
        main(int(sys.argv[1]), float(sys.argv[2]), float(sys.argv[3]))
    else:
        print("Usage: main.py <Number of points (ℕ)> <Theta (degrees, 0.0-90.0)> <Mew (scalar, 0.0-1.0)>")
